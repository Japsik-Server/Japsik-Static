<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Code Generator</title>
<style>
	body {
		font-family: Arial, sans-serif;
	}
	#preview {
		width: 80%;
		border: 1px solid #ccc;
		padding: 10px;
		margin-top: 20px;
		overflow-y: auto;
		white-space: pre-wrap; /* 줄 바꿈 유지 */
	}
	#output {
		width: 80%;
		border: 1px solid #ccc;
		padding: 10px;
		margin-top: 20px;
		overflow-y: auto;
	}
	#copyButton {
		margin-top: 10px;
		padding: 5px 10px;
		background-color: #007bff;
		color: #fff;
		border: none;
		cursor: pointer;
		border-radius: 3px;
	}
</style>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
	<h2>RSS Item Builder</h2>
	<form id="inputForm">
		<label for="title">제목:</label><br>
		<input type="text" id="title" name="title"><br><br>
		<label for="author">작성자:</label><br>
		<input type="text" id="author" name="author"><br><br>
		<label for="date">날짜:</label><br>
		<input type="datetime-local" id="date" name="date"><br><br>
		<label for="content">내용 (Markdown):</label><br>
		<textarea id="content" name="content" rows="4" oninput="updatePreview()"></textarea><br><br>
		<button type="button" onclick="generateCode()">Build</button>
	</form>
	<div id="preview"></div>
	<pre id="output"></pre>
	<button id="copyButton" onclick="copyCode()">Copy XML</button>

<script>
	function generateCode() {
		var title = document.getElementById('title').value;
		var author = document.getElementById('author').value;
		var dateInput = document.getElementById('date').value;
		var content = document.getElementById('content').value;

		// Check if date is empty
		if (!dateInput) {
			alert('날짜를 입력해 주세요.');
			return;
		}

		var date = new Date(dateInput);

		// Convert date input to desired format
		var formattedDate = formatDate(date);

		// Convert Markdown content to HTML using Marked.js
		var htmlContent = marked.parse(content);

		// Remove newline characters from htmlContent
		htmlContent = htmlContent.replace(/\n/g, '');

		// Generate HTML code
		var htmlCode = `<item>
	<title>${title}</title>
	<content:encoded>
		<![CDATA[ ${htmlContent} ]]>
	</content:encoded>
	<dc:creator>${author}</dc:creator>
	<pubDate>${formattedDate}:10</pubDate>
</item>`;

		// Set output div's innerHTML to htmlCode
		document.getElementById('output').textContent = htmlCode;
	}

	function updatePreview() {
		var content = document.getElementById('content').value;
		var htmlContent = marked.parse(content);
		document.getElementById('preview').innerHTML = htmlContent;
	}

	function formatDate(date) {
		var options = { 
			day: '2-digit', 
			month: 'long',	// 월을 "long"으로 변경
			year: 'numeric', 
			hour: '2-digit', 
			minute: '2-digit'
		};
		var dateString = date.toLocaleString('en-US', options);

		// 쉼표 제거
		dateString = dateString.replace(',', '');

		// 날짜와 월의 위치 변경
		var parts = dateString.split(' ');
		return parts[1] + ' ' + parts[0] + ' ' + parts[2] + ' ' + parts[4];
	}

	function copyCode() {
		var output = document.getElementById('output');
		var range = document.createRange();
		range.selectNode(output);
		window.getSelection().removeAllRanges(); // Clear previous selections
		window.getSelection().addRange(range); // Select text
		document.execCommand('copy'); // Copy text to clipboard
		window.getSelection().removeAllRanges(); // Clear selection
		alert('복사되었습니다!');
	}
</script>

</body>
</html>
